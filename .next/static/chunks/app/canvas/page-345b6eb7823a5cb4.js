(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[423],{20215:(e,t,a)=>{"use strict";function s(e,t){var a,s,r,i,n,l,o,c;let d,u,m=null!=(s=null!=(a=e.front)?a:e.all)?s:0,g=null!=(i=null!=(r=e.back)?r:e.all)?i:0,h=null!=(l=null!=(n=e.left)?n:e.all)?l:0,p=null!=(c=null!=(o=e.right)?o:e.all)?c:0;"rectangle"===t.shape?(d=t.width,u=t.height):d=u=2*t.radius;let x=d/2,b=u/2;return{type:"custom",points:[{x:-x-h,y:-b-m},{x:x+p,y:-b-m},{x:x+p,y:b+g},{x:-x-h,y:b+g}],closed:!0}}function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return s({type:"rectangular",all:t},e)}function i(e,t){var a,s;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8;if(!e.curveType||"none"===e.curveType)return[{x:e.x,y:e.y},{x:t.x,y:t.y}];let i=null!=(a=e.curveAngle)?a:90,n=null!=(s=e.curveDirection)?s:"clockwise",l=(e.x+t.x)/2,o=(e.y+t.y)/2,c=t.x-e.x,d=t.y-e.y,u=Math.sqrt(c*c+d*d),m=i*Math.PI/180,g=u/(2*Math.sin(m/2)),h=g*Math.cos(m/2),p=l+-d/u*h*("clockwise"===n?1:-1),x=o+c/u*h*("clockwise"===n?1:-1),b=Math.atan2(e.y-x,e.x-p),y=(Math.atan2(t.y-x,t.x-p)-b)/r;"clockwise"===n&&y>0&&(y-=2*Math.PI),"counterclockwise"===n&&y<0&&(y+=2*Math.PI);let f=[];for(let e=0;e<=r;e++){let t=b+y*e;f.push({x:p+g*Math.cos(t),y:x+g*Math.sin(t)})}return f}function n(e){if(e.points.length<2)return[];let t=[];for(let a=0;a<e.points.length;a++){let s=i(e.points[a],e.points[(a+1)%e.points.length]);for(let e=0;e<s.length-1;e++)t.push(s[e])}if(e.closed&&e.points.length>0){let a=i(e.points[e.points.length-1],e.points[0]);a.length>1&&t.push(a[a.length-1])}return t}function l(e){let t=[];for(let a of(e.points.length<3&&t.push("Clearance polygon must have at least 3 points"),e.points.length>20&&t.push("Clearance polygon cannot have more than 20 points"),e.points))a.curveAngle&&![45,90,180].includes(a.curveAngle)&&t.push("Invalid curve angle: ".concat(a.curveAngle,". Must be 45, 90, or 180 degrees"));return t}a.d(t,{Lt:()=>n,U7:()=>r,Xz:()=>s,iR:()=>l})},24879:(e,t,a)=>{"use strict";a.d(t,{TI:()=>i,ZP:()=>r,ge:()=>s});let s=[{id:"bounce",name:"Bounce",category:"rides",dimensions:{shape:"rectangle",width:20,height:25},clearance:{type:"rectangular",all:10},color:"#FF6B6B",description:"Bounce - Professional amusement ride",specifications:{capacity:50,weight:25e3},tags:["amusement","ride","professional"],weight:25e3,capacity:50,turnAroundTime:3,verticalHeight:20,rideClearing:10},{id:"century-wheel",name:"Century Wheel",category:"rides",dimensions:{shape:"circle",radius:26.5},clearance:{type:"rectangular",all:12},color:"#4ECDC4",description:"Century Wheel - Professional amusement ride",specifications:{capacity:186,weight:92750},tags:["amusement","ride","professional"],weight:92750,capacity:186,turnAroundTime:3,verticalHeight:42,rideClearing:12},{id:"cliffhanger",name:"Cliffhanger",category:"rides",dimensions:{shape:"rectangle",width:64,height:70},clearance:{type:"rectangular",all:27},color:"#45B7D1",description:"Cliffhanger - Professional amusement ride",specifications:{capacity:448,weight:224e3},tags:["amusement","ride","professional"],weight:224e3,capacity:448,turnAroundTime:3,verticalHeight:56,rideClearing:27},{id:"crystal-lils",name:"Crystal Lils",category:"rides",dimensions:{shape:"rectangle",width:70,height:18},clearance:{type:"rectangular",all:6},color:"#96CEB4",description:"Crystal Lils - Professional amusement ride - 9-48-13>",specifications:{capacity:126,weight:63e3},tags:["amusement","ride","professional"],weight:63e3,capacity:126,turnAroundTime:3,verticalHeight:56,rideClearing:6},{id:"dizzy-dragon",name:"Dizzy Dragon",category:"rides",dimensions:{shape:"rectangle",width:30,height:33},clearance:{type:"rectangular",all:18},color:"#FFEAA7",description:"Dizzy Dragon - Professional amusement ride - (8'6)",specifications:{capacity:99,weight:49500},tags:["amusement","ride","professional"],weight:49500,capacity:99,turnAroundTime:3,verticalHeight:26,rideClearing:18},{id:"dragon-wagon",name:"Dragon Wagon",category:"rides",dimensions:{shape:"rectangle",width:70,height:30},clearance:{type:"rectangular",all:3},color:"#DDA0DD",description:"Dragon Wagon - Professional amusement ride - <22-28-17",specifications:{capacity:210,weight:105e3},tags:["amusement","ride","professional"],weight:105e3,capacity:210,turnAroundTime:3,verticalHeight:56,rideClearing:3},{id:"euro-wheel",name:"Euro Wheel",category:"rides",dimensions:{shape:"circle",radius:24},clearance:{type:"rectangular",all:7},color:"#98D8C8",description:"Euro Wheel - Professional amusement ride",specifications:{capacity:106,weight:52800},tags:["amusement","ride","professional"],weight:52800,capacity:106,turnAroundTime:3,verticalHeight:38,rideClearing:7},{id:"farm-train",name:"Farm Train",category:"rides",dimensions:{shape:"rectangle",width:60,height:30},clearance:{type:"rectangular",all:21},color:"#F7DC6F",description:"Farm Train - Professional amusement ride - <14-32-14",specifications:{capacity:180,weight:9e4},tags:["amusement","ride","professional"],weight:9e4,capacity:180,turnAroundTime:3,verticalHeight:48,rideClearing:21},{id:"freak-out",name:"Freak Out",category:"rides",dimensions:{shape:"rectangle",width:48,height:56},clearance:{type:"rectangular",all:14},color:"#BB8FCE",description:"Freak Out - Professional amusement ride - >",specifications:{capacity:269,weight:134400},tags:["amusement","ride","professional"],weight:134400,capacity:269,turnAroundTime:3,verticalHeight:45,rideClearing:14},{id:"fury",name:"Fury",category:"rides",dimensions:{shape:"rectangle",width:53,height:30},clearance:{type:"rectangular",all:10},color:"#85C1E9",description:"Fury - Professional amusement ride - <17-53-17> OR-5'",specifications:{capacity:159,weight:79500},tags:["amusement","ride","professional"],weight:79500,capacity:159,turnAroundTime:3,verticalHeight:42,rideClearing:10},{id:"himalaya",name:"Himalaya",category:"rides",dimensions:{shape:"rectangle",width:55,height:46},clearance:{type:"rectangular",all:22},color:"#F8C471",description:"Himalaya - Professional amusement ride - BS-16'",specifications:{capacity:253,weight:126500},tags:["amusement","ride","professional"],weight:126500,capacity:253,turnAroundTime:3,verticalHeight:44,rideClearing:22},{id:"magic-maze",name:"Magic Maze",category:"rides",dimensions:{shape:"rectangle",width:70,height:18},clearance:{type:"rectangular",all:6},color:"#82E0AA",description:"Magic Maze - Professional amusement ride - 9-48-13>",specifications:{capacity:126,weight:63e3},tags:["amusement","ride","professional"],weight:63e3,capacity:126,turnAroundTime:3,verticalHeight:56,rideClearing:6},{id:"mgr",name:"MGR",category:"rides",dimensions:{shape:"rectangle",width:42,height:42},clearance:{type:"rectangular",all:24},color:"#F1948A",description:"MGR - Professional amusement ride",specifications:{capacity:176,weight:88200},tags:["amusement","ride","professional"],weight:88200,capacity:176,turnAroundTime:3,verticalHeight:34,rideClearing:24},{id:"mini-mgr",name:"Mini MGR",category:"rides",dimensions:{shape:"rectangle",width:22,height:25},clearance:{type:"rectangular",all:14},color:"#85C1E9",description:"Mini MGR - Professional amusement ride",specifications:{capacity:55,weight:27500},tags:["amusement","ride","professional"],weight:27500,capacity:55,turnAroundTime:3,verticalHeight:20,rideClearing:14},{id:"motorcycles",name:"Motorcycles",category:"rides",dimensions:{shape:"rectangle",width:30,height:33},clearance:{type:"rectangular",all:18},color:"#D7BDE2",description:"Motorcycles - Professional amusement ride",specifications:{capacity:99,weight:49500},tags:["amusement","ride","professional"],weight:49500,capacity:99,turnAroundTime:3,verticalHeight:26,rideClearing:18},{id:"raiders",name:"Raiders",category:"rides",dimensions:{shape:"rectangle",width:60,height:18},clearance:{type:"rectangular",all:6},color:"#A3E4D7",description:"Raiders - Professional amusement ride - 16-28-24>",specifications:{capacity:108,weight:54e3},tags:["amusement","ride","professional"],weight:54e3,capacity:108,turnAroundTime:3,verticalHeight:48,rideClearing:6},{id:"ring",name:"Ring",category:"rides",dimensions:{shape:"rectangle",width:60,height:60},clearance:{type:"rectangular",all:16},color:"#F9E79F",description:"Ring - Professional amusement ride - 7-46-7>",specifications:{capacity:360,weight:18e4},tags:["amusement","ride","professional"],weight:18e4,capacity:360,turnAroundTime:3,verticalHeight:48,rideClearing:16},{id:"rockstar",name:"Rockstar",category:"rides",dimensions:{shape:"rectangle",width:50,height:24},clearance:{type:"rectangular",all:10},color:"#D5A6BD",description:"Rockstar - Professional amusement ride - 22-50-10> BS-6'",specifications:{capacity:120,weight:6e4},tags:["amusement","ride","professional"],weight:6e4,capacity:120,turnAroundTime:3,verticalHeight:40,rideClearing:10},{id:"sand-storm",name:"Sand Storm",category:"rides",dimensions:{shape:"rectangle",width:50,height:24},clearance:{type:"rectangular",all:10},color:"#AED6F1",description:"Sand Storm - Professional amusement ride - 20-48-56>",specifications:{capacity:120,weight:6e4},tags:["amusement","ride","professional"],weight:6e4,capacity:120,turnAroundTime:3,verticalHeight:40,rideClearing:10},{id:"sizzler",name:"Sizzler",category:"rides",dimensions:{shape:"rectangle",width:60,height:60},clearance:{type:"rectangular",all:10},color:"#A9DFBF",description:"Sizzler - Professional amusement ride",specifications:{capacity:360,weight:18e4},tags:["amusement","ride","professional"],weight:18e4,capacity:360,turnAroundTime:3,verticalHeight:48,rideClearing:10},{id:"slide",name:"Slide",category:"rides",dimensions:{shape:"rectangle",width:20,height:105},clearance:{type:"rectangular",all:4},color:"#F5B7B1",description:"Slide - Professional amusement ride - 04 (Secondary clearance: 12ft)",specifications:{capacity:210,weight:105e3},tags:["amusement","ride","professional"],weight:105e3,capacity:210,turnAroundTime:3,verticalHeight:84,rideClearing:4},{id:"speedway",name:"Speedway",category:"rides",dimensions:{shape:"rectangle",width:55,height:22},clearance:{type:"rectangular",all:10},color:"#D2B4DE",description:"Speedway - Professional amusement ride - <7-24-7",specifications:{capacity:121,weight:60500},tags:["amusement","ride","professional"],weight:60500,capacity:121,turnAroundTime:3,verticalHeight:44,rideClearing:10},{id:"starship",name:"Starship",category:"rides",dimensions:{shape:"rectangle",width:56,height:40},clearance:{type:"rectangular",all:10},color:"#A9CCE3",description:"Starship - Professional amusement ride - <4-46-6 BS-13'",specifications:{capacity:224,weight:112e3},tags:["amusement","ride","professional"],weight:112e3,capacity:224,turnAroundTime:3,verticalHeight:45,rideClearing:10},{id:"swings",name:"Swings",category:"rides",dimensions:{shape:"rectangle",width:30,height:30},clearance:{type:"rectangular",all:10},color:"#A3E4D7",description:"Swings - Professional amusement ride",specifications:{capacity:90,weight:45e3},tags:["amusement","ride","professional"],weight:45e3,capacity:90,turnAroundTime:3,verticalHeight:24,rideClearing:10},{id:"tornado",name:"Tornado",category:"rides",dimensions:{shape:"rectangle",width:45,height:30},clearance:{type:"rectangular",all:10},color:"#F7DC6F",description:"Tornado - Professional amusement ride",specifications:{capacity:135,weight:67500},tags:["amusement","ride","professional"],weight:67500,capacity:135,turnAroundTime:3,verticalHeight:36,rideClearing:10},{id:"vertigo",name:"Vertigo",category:"rides",dimensions:{shape:"rectangle",width:80,height:40},clearance:{type:"rectangular",all:10},color:"#D7BDE2",description:"Vertigo - Professional amusement ride",specifications:{capacity:320,weight:16e4},tags:["amusement","ride","professional"],weight:16e4,capacity:320,turnAroundTime:3,verticalHeight:64,rideClearing:10},{id:"wacky-shack",name:"Wacky Shack",category:"rides",dimensions:{shape:"rectangle",width:40,height:16},clearance:{type:"rectangular",all:9},color:"#AED6F1",description:"Wacky Shack - Professional amusement ride - 13> (Secondary clearance: 50'6ft)",specifications:{capacity:64,weight:32e3},tags:["amusement","ride","professional"],weight:32e3,capacity:64,turnAroundTime:3,verticalHeight:32,rideClearing:9},{id:"zero-gravity",name:"Zero Gravity",category:"rides",dimensions:{shape:"rectangle",width:70,height:30},clearance:{type:"rectangular",all:10},color:"#A9DFBF",description:"Zero Gravity - Professional amusement ride",specifications:{capacity:210,weight:105e3},tags:["amusement","ride","professional"],weight:105e3,capacity:210,turnAroundTime:3,verticalHeight:56,rideClearing:10},{id:"zipper",name:"Zipper",category:"rides",dimensions:{shape:"rectangle",width:56,height:60},clearance:{type:"rectangular",all:13},color:"#F5B7B1",description:"Zipper - Professional amusement ride - 21-8-21(3)",specifications:{capacity:336,weight:168e3},tags:["amusement","ride","professional"],weight:168e3,capacity:336,turnAroundTime:3,verticalHeight:48,rideClearing:13}],r={rides:s.filter(e=>"rides"===e.category)};function i(e){let t=e.toLowerCase();return s.filter(e=>{var a,s;return e.name.toLowerCase().includes(t)||(null==(a=e.description)?void 0:a.toLowerCase().includes(t))||(null==(s=e.tags)?void 0:s.some(e=>e.toLowerCase().includes(t)))})}},28521:(e,t,a)=>{Promise.resolve().then(a.bind(a,90089))},90089:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>S});var s=a(95155),r=a(12115),i=a(55028);let n="1.0.0",l=".lotplan";class o{static createNewProject(e,t){let a=new Date().toISOString();return{metadata:{id:"project_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),name:e,description:t,createdAt:a,updatedAt:a,version:n,author:"Lot Planner User"},canvasSettings:{width:1e4,height:1e4,pixelsPerFoot:10,gridSize:50,gridVisible:!0,scaleBarVisible:!0,measurementToolActive:!1},placedEquipment:[],backgroundImages:[],equipmentDefinitions:[],customEquipmentCount:0}}static exportProject(e,t,a,s,r){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},l={includeBackgroundImages:!0,includeCustomEquipment:!0,compressionLevel:"none",format:"json",...i},o=new Date().toISOString();return JSON.stringify({metadata:{id:"export_".concat(Date.now()),name:r,description:"Exported Lot Planner project",createdAt:o,updatedAt:o,version:n},canvasSettings:{width:1e4,height:1e4,pixelsPerFoot:10,gridSize:50,gridVisible:!0,scaleBarVisible:!0,measurementToolActive:!1},placedEquipment:e,backgroundImages:l.includeBackgroundImages?t:[],equipmentDefinitions:l.includeCustomEquipment?a:[],customEquipmentCount:s},null,2)}static importProject(e){try{let t=JSON.parse(e);if(!t.metadata||!t.placedEquipment||!t.backgroundImages)return{success:!1,error:"Invalid project file format: missing required fields"};let a=[];t.metadata.version!==n&&a.push("Project was created with version ".concat(t.metadata.version,", current version is ").concat(n));let s={...t,canvasSettings:{width:1e4,height:1e4,pixelsPerFoot:10,gridSize:50,gridVisible:!0,scaleBarVisible:!0,measurementToolActive:!1,...t.canvasSettings},equipmentDefinitions:t.equipmentDefinitions||[],customEquipmentCount:t.customEquipmentCount||0};return{success:!0,data:s,warnings:a.length>0?a:void 0}}catch(e){return{success:!1,error:"Failed to parse project file: ".concat(e instanceof Error?e.message:"Unknown error")}}}static saveProject(e){try{let t=this.getSavedProjects(),a=t.findIndex(t=>t.metadata.id===e.metadata.id);return e.metadata.updatedAt=new Date().toISOString(),a>=0?t[a]=e:t.push(e),localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t)),{success:!0,projectId:e.metadata.id}}catch(e){return{success:!1,error:"Failed to save project: ".concat(e instanceof Error?e.message:"Unknown error")}}}static loadProject(e){try{return this.getSavedProjects().find(t=>t.metadata.id===e)||null}catch(e){return console.error("Failed to load project:",e),null}}static getSavedProjects(){try{let e=localStorage.getItem(this.STORAGE_KEY);return e?JSON.parse(e):[]}catch(e){return console.error("Failed to get saved projects:",e),[]}}static deleteProject(e){try{let t=this.getSavedProjects().filter(t=>t.metadata.id!==e);return localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t)),!0}catch(e){return console.error("Failed to delete project:",e),!1}}static autoSave(e,t,a,s){try{let r={timestamp:new Date().toISOString(),placedEquipment:e,backgroundImages:t,equipmentDefinitions:a,customEquipmentCount:s};localStorage.setItem(this.AUTOSAVE_KEY,JSON.stringify(r))}catch(e){console.error("Auto-save failed:",e)}}static loadAutoSave(){try{let e=localStorage.getItem(this.AUTOSAVE_KEY);return e?JSON.parse(e):null}catch(e){return console.error("Failed to load auto-save:",e),null}}static clearAutoSave(){try{localStorage.removeItem(this.AUTOSAVE_KEY)}catch(e){console.error("Failed to clear auto-save:",e)}}static downloadProject(e,t){let a=new Blob([e],{type:"application/json"}),s=URL.createObjectURL(a),r=document.createElement("a");r.href=s,r.download=t.endsWith(l)?t:"".concat(t).concat(l),document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(s)}static readProjectFile(e){return new Promise((t,a)=>{let s=new FileReader;s.onload=e=>{var s;let r=null==(s=e.target)?void 0:s.result;"string"==typeof r?t(r):a(Error("Failed to read file as text"))},s.onerror=()=>{a(Error("Failed to read file"))},s.readAsText(e)})}}o.STORAGE_KEY="lotplanner_projects",o.AUTOSAVE_KEY="lotplanner_autosave",o.AUTOSAVE_INTERVAL=3e4;var c=a(24879),d=a(20215);function u(e){var t,a,i,n,l;let{clearance:o,dimensions:c,rideClearing:u=0,onChange:m,onClose:g}=e,[h,p]=(0,r.useState)("rectangular"),[x,b]=(0,r.useState)(()=>{if((null==o?void 0:o.type)==="custom")return o;let e=(null==o?void 0:o.type)==="rectangular"?o:{type:"rectangular",all:u};return(0,d.Xz)(e,c)}),[y,f]=(0,r.useState)(()=>(null==o?void 0:o.type)==="rectangular"?o:{type:"rectangular",all:u}),[j,v]=(0,r.useState)(null),[N,w]=(0,r.useState)(()=>{if((null==o?void 0:o.type)==="custom")return(0,d.iR)(o);let e=(null==o?void 0:o.type)==="rectangular"?o:{type:"rectangular",all:u},t=(0,d.Xz)(e,c);return(0,d.iR)(t)}),C=(0,r.useCallback)(e=>{let t=(0,d.iR)(e);w(t),b(e),0===t.length&&m(e)},[m]),k=(0,r.useCallback)(()=>{if(x.points.length>=20)return;let e=[...x.points,{x:0,y:-20,curveType:"none"}];C({...x,points:e})},[x,C]),S=(0,r.useCallback)(e=>{if(x.points.length<=3)return;let t=x.points.filter((t,a)=>a!==e);C({...x,points:t}),v(null)},[x,C]),E=(0,r.useCallback)((e,t)=>{let a=x.points.map((a,s)=>s===e?{...a,...t}:a);C({...x,points:a})},[x,C]),D=(0,r.useCallback)(e=>{let t={...y,...e};f(t),m(t)},[y,m]);return(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsx)("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto text-gray-900",style:{color:"#111827"},children:(0,s.jsxs)("div",{className:"p-6 text-gray-900",style:{color:"#111827"},children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold",children:"Edit Custom Clearance Zone"}),(0,s.jsx)("button",{onClick:g,className:"text-gray-400 hover:text-gray-600 text-2xl",children:"\xd7"})]}),(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)("button",{onClick:()=>p("rectangular"),className:"px-4 py-2 rounded ".concat("rectangular"===h?"bg-blue-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:"Rectangular Clearance"}),(0,s.jsx)("button",{onClick:()=>p("custom"),className:"px-4 py-2 rounded ".concat("custom"===h?"bg-blue-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:"Custom Polygon"})]})}),"rectangular"===h&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1 text-gray-900",style:{color:"#111827 !important"},children:"Front (ft)"}),(0,s.jsx)("input",{type:"number",value:null!=(t=y.front)?t:"",onChange:e=>D({front:e.target.value?parseFloat(e.target.value):void 0}),className:"w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 hover:border-gray-400 bg-white",placeholder:"0",min:"0",step:"0.5"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1 text-gray-900",style:{color:"#111827 !important"},children:"Back (ft)"}),(0,s.jsx)("input",{type:"number",value:null!=(a=y.back)?a:"",onChange:e=>D({back:e.target.value?parseFloat(e.target.value):void 0}),className:"w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 hover:border-gray-400 bg-white",placeholder:"0",min:"0",step:"0.5"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1 text-gray-900",style:{color:"#111827 !important"},children:"Left (ft)"}),(0,s.jsx)("input",{type:"number",value:null!=(i=y.left)?i:"",onChange:e=>D({left:e.target.value?parseFloat(e.target.value):void 0}),className:"w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 hover:border-gray-400 bg-white",placeholder:"0",min:"0",step:"0.5"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1 text-gray-900",style:{color:"#111827 !important"},children:"Right (ft)"}),(0,s.jsx)("input",{type:"number",value:null!=(n=y.right)?n:"",onChange:e=>D({right:e.target.value?parseFloat(e.target.value):void 0}),className:"w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 hover:border-gray-400 bg-white",placeholder:"0",min:"0",step:"0.5"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1 text-gray-900",style:{color:"#111827 !important"},children:"All Sides (ft)"}),(0,s.jsx)("input",{type:"number",value:null!=(l=y.all)?l:"",onChange:e=>D({all:e.target.value?parseFloat(e.target.value):void 0}),className:"w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 hover:border-gray-400 bg-white",placeholder:"0",min:"0",step:"0.5"}),(0,s.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Setting this will override individual side values"})]})]}),"custom"===h&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("h3",{className:"text-lg font-medium",style:{color:"#111827"},children:"Polygon Points"}),(0,s.jsx)("button",{onClick:k,disabled:x.points.length>=20,className:"px-3 py-1 bg-green-500 text-white rounded text-sm disabled:bg-gray-300",children:"Add Point"})]}),N.length>0&&(0,s.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded p-3",children:[(0,s.jsx)("h4",{className:"text-red-800 font-medium mb-1",children:"Validation Errors:"}),(0,s.jsx)("ul",{className:"text-red-700 text-sm",children:N.map((e,t)=>(0,s.jsxs)("li",{children:["• ",e]},t))})]}),(0,s.jsx)("div",{className:"max-h-60 overflow-y-auto space-y-3",children:x.points.map((e,t)=>(0,s.jsxs)("div",{className:"border rounded p-3 ".concat(j===t?"border-blue-500 bg-blue-50":"border-gray-200"),children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,s.jsxs)("span",{className:"font-medium",style:{color:"#111827"},children:["Point ",t+1]}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)("button",{onClick:()=>v(j===t?null:t),className:"text-blue-500 text-sm",children:j===t?"Collapse":"Edit"}),(0,s.jsx)("button",{onClick:()=>S(t),disabled:x.points.length<=3,className:"text-red-500 text-sm disabled:text-gray-400",children:"Remove"})]})]}),j===t&&(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"point-".concat(t,"-x"),className:"block text-sm font-medium mb-1 text-gray-900",style:{color:"#111827"},children:"X Position (ft)"}),(0,s.jsx)("input",{type:"number",id:"point-".concat(t,"-x"),value:e.x,onChange:e=>E(t,{x:parseFloat(e.target.value)||0}),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 hover:border-gray-400 bg-white",step:"0.5","aria-label":"Point ".concat(t+1," X Position")})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"point-".concat(t,"-y"),className:"block text-sm font-medium mb-1 text-gray-900",style:{color:"#111827"},children:"Y Position (ft)"}),(0,s.jsx)("input",{type:"number",id:"point-".concat(t,"-y"),value:e.y,onChange:e=>E(t,{y:parseFloat(e.target.value)||0}),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 hover:border-gray-400 bg-white",step:"0.5","aria-label":"Point ".concat(t+1," Y Position")})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"point-".concat(t,"-curve-type"),className:"block text-sm font-medium mb-1 text-gray-900",style:{color:"#111827"},children:"Curve Type"}),(0,s.jsxs)("select",{id:"point-".concat(t,"-curve-type"),value:e.curveType||"none",onChange:e=>E(t,{curveType:e.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 hover:border-gray-400 bg-white","aria-label":"Point ".concat(t+1," Curve Type"),children:[(0,s.jsx)("option",{value:"none",children:"Straight"}),(0,s.jsx)("option",{value:"arc",children:"Curved"})]})]}),"arc"===e.curveType&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"point-".concat(t,"-curve-angle"),className:"block text-sm font-medium mb-1 text-gray-900",children:"Curve Angle"}),(0,s.jsxs)("select",{id:"point-".concat(t,"-curve-angle"),value:e.curveAngle||90,onChange:e=>E(t,{curveAngle:parseInt(e.target.value)}),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 hover:border-gray-400 bg-white","aria-label":"Point ".concat(t+1," Curve Angle"),children:[(0,s.jsx)("option",{value:45,children:"45\xb0"}),(0,s.jsx)("option",{value:90,children:"90\xb0"}),(0,s.jsx)("option",{value:180,children:"180\xb0"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"point-".concat(t,"-curve-direction"),className:"block text-sm font-medium mb-1 text-gray-900",children:"Direction"}),(0,s.jsxs)("select",{id:"point-".concat(t,"-curve-direction"),value:e.curveDirection||"clockwise",onChange:e=>E(t,{curveDirection:e.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 hover:border-gray-400 bg-white","aria-label":"Point ".concat(t+1," Curve Direction"),children:[(0,s.jsx)("option",{value:"clockwise",children:"Clockwise"}),(0,s.jsx)("option",{value:"counterclockwise",children:"Counter-clockwise"})]})]})]})]})]},t))}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("input",{type:"checkbox",id:"closed",checked:x.closed,onChange:e=>C({...x,closed:e.target.checked})}),(0,s.jsx)("label",{htmlFor:"closed",className:"text-sm text-gray-900",children:"Close polygon"})]})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3 mt-6 pt-4 border-t",children:[(0,s.jsx)("button",{onClick:g,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded hover:bg-gray-50",children:"Cancel"}),(0,s.jsx)("button",{onClick:g,disabled:N.length>0,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:bg-gray-300",children:"Apply Changes"})]})]})})})}function m(e){let{equipmentDefinitions:t,onEquipmentDefinitionsUpdate:a,customSettings:i,isOpen:n,onClose:l}=e,[o,c]=(0,r.useState)("merge"),[d,u]=(0,r.useState)(""),[m,g]=(0,r.useState)(""),[h,p]=(0,r.useState)(!1),[x,b]=(0,r.useState)(!1);return n?(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsx)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"Equipment Library Manager"}),(0,s.jsx)("button",{onClick:l,className:"text-gray-500 hover:text-gray-700 text-2xl font-bold","aria-label":"Close",children:"\xd7"})]}),(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsxs)("div",{className:"border-b pb-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Export Equipment Library"}),(0,s.jsxs)("p",{className:"text-gray-600 mb-4",children:["Save your current equipment library (",t.length," items) to a file that can be imported into other projects."]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"export-description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description (Optional)"}),(0,s.jsx)("input",{id:"export-description",type:"text",value:d,onChange:e=>u(e.target.value),placeholder:"e.g., My Custom Carnival Equipment Library",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 bg-white placeholder-gray-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"export-author",className:"block text-sm font-medium text-gray-700 mb-1",children:"Author (Optional)"}),(0,s.jsx)("input",{id:"export-author",type:"text",value:m,onChange:e=>g(e.target.value),placeholder:"Your name or organization",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 bg-white placeholder-gray-500"})]}),(0,s.jsx)("button",{onClick:()=>{p(!0);try{let e={version:"1.0.0",exportDate:new Date().toISOString(),equipmentCount:t.length,equipment:t,customSettings:i,metadata:{description:d||"Custom equipment library export",author:m||"Lot Planner User",tags:["equipment","library","custom"]}},a=JSON.stringify(e,null,2),s=new Blob([a],{type:"application/json"}),r=URL.createObjectURL(s),n=document.createElement("a");n.href=r,n.download="equipment-library-".concat(new Date().toISOString().split("T")[0],".json"),document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(r),console.log("Equipment library exported successfully:",e)}catch(e){console.error("Error exporting equipment library:",e),alert("Error exporting equipment library. Please try again.")}finally{p(!1)}},disabled:h,className:"bg-green-500 text-white px-6 py-2 rounded-md hover:bg-green-600 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:h?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,s.jsx)("span",{children:"Exporting..."})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{children:"\uD83D\uDCC1"}),(0,s.jsx)("span",{children:"Export Library"})]})})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Import Equipment Library"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:"Load equipment definitions from a previously exported library file."}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Import Mode"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("label",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"radio",value:"merge",checked:"merge"===o,onChange:e=>c(e.target.value),className:"mr-2"}),(0,s.jsxs)("span",{className:"text-sm",children:[(0,s.jsx)("strong",{children:"Merge:"})," Update existing equipment and add new ones (Recommended)"]})]}),(0,s.jsxs)("label",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"radio",value:"append",checked:"append"===o,onChange:e=>c(e.target.value),className:"mr-2"}),(0,s.jsxs)("span",{className:"text-sm",children:[(0,s.jsx)("strong",{children:"Append:"})," Add all imported equipment as new items"]})]}),(0,s.jsxs)("label",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"radio",value:"replace",checked:"replace"===o,onChange:e=>c(e.target.value),className:"mr-2"}),(0,s.jsxs)("span",{className:"text-sm text-red-600",children:[(0,s.jsx)("strong",{children:"Replace:"})," Replace entire library (Warning: This will delete all current equipment)"]})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"import-file",className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Equipment Library File"}),(0,s.jsx)("input",{id:"import-file",type:"file",accept:".json",onChange:e=>{var s;let r=null==(s=e.target.files)?void 0:s[0];if(!r)return;b(!0);let i=new FileReader;i.onload=s=>{try{var r;let i=null==(r=s.target)?void 0:r.result,n=JSON.parse(i);if(!n.equipment||!Array.isArray(n.equipment))throw Error("Invalid equipment library file format");let l=[];switch(o){case"replace":l=n.equipment;break;case"merge":let c=new Set(t.map(e=>e.id)),d=n.equipment.map(e=>({...e,id:(c.has(e.id),e.id)}));l=[...t],d.forEach(e=>{let t=l.findIndex(t=>t.id===e.id);t>=0?l[t]=e:l.push(e)});break;case"append":let u=n.equipment.map(e=>({...e,id:"imported-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9))}));l=[...t,...u]}a(l,n.customSettings),console.log("Equipment library imported successfully:",{mode:o,imported:n.equipment.length,total:l.length,customSettings:n.customSettings?"included":"none"});let m=n.customSettings?"\nCustom settings restored!":"\nNo custom settings found.";alert("Equipment library imported successfully!\nMode: ".concat(o,"\nImported: ").concat(n.equipment.length," items\nTotal: ").concat(l.length," items").concat(m)),e.target.value=""}catch(e){console.error("Error importing equipment library:",e),alert("Error importing equipment library. Please check the file format and try again.")}finally{b(!1)}},i.readAsText(r)},disabled:x,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 text-gray-900 bg-white"}),x&&(0,s.jsxs)("div",{className:"mt-2 flex items-center space-x-2 text-blue-600",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),(0,s.jsx)("span",{className:"text-sm",children:"Importing equipment library..."})]})]})]})]})]})]})})}):null}let g={"mega-rides":"Mega Rides",rides:"Rides","kiddy-rides":"Kiddy Rides",food:"Food",games:"Games",equipment:"Equipment",office:"Office",home:"Home",bunks:"Bunks"},h={"mega-rides":"\uD83C\uDFA2",rides:"\uD83C\uDFA0","kiddy-rides":"\uD83C\uDFAA",food:"\uD83C\uDF54",games:"\uD83C\uDFAF",equipment:"⚙️",office:"\uD83C\uDFE2",home:"\uD83C\uDFE0",bunks:"\uD83D\uDECF️"},p=e=>{let{onEquipmentSelect:t,onEquipmentDefinitionsChange:a,onLibraryStateChange:i,initialLibraryState:n,className:l="",style:o,isCollapsed:d=!1}=e,[p,x]=(0,r.useState)("all"),[b,y]=(0,r.useState)(""),[f,j]=(0,r.useState)(new Set),[v,N]=(0,r.useState)(new Set),[w,C]=(0,r.useState)({}),[k,S]=(0,r.useState)({}),[E,D]=(0,r.useState)({}),[P,F]=(0,r.useState)({}),[q,A]=(0,r.useState)({}),[L,T]=(0,r.useState)({}),[I,M]=(0,r.useState)({}),[B,z]=(0,r.useState)({}),[O,R]=(0,r.useState)({}),[H,_]=(0,r.useState)(null),[U,W]=(0,r.useState)([]),[V,G]=(0,r.useState)(0),[Z,Y]=(0,r.useState)(!1);(0,r.useEffect)(()=>{n&&(C(n.customDimensions||{}),S(n.customCategories||{}),D(n.customNames||{}),F(n.customWeight||{}),A(n.customCapacity||{}),T(n.customTurnAroundTime||{}),M(n.customVerticalHeight||{}),z(n.customRideClearing||{}),R(n.customClearances||{}),W(n.newEquipmentItems||[]),G(n.newEquipmentCounter||0))},[n]),(0,r.useEffect)(()=>{i&&i({customDimensions:w,customCategories:k,customNames:E,customWeight:P,customCapacity:q,customTurnAroundTime:L,customVerticalHeight:I,customRideClearing:B,customClearances:O,newEquipmentItems:U,newEquipmentCounter:V})},[w,k,E,P,q,L,I,B,O,U,V,i]);let X=(0,r.useMemo)(()=>[...Object.values(c.ZP).flat(),...U],[U]);(0,r.useEffect)(()=>{a&&a(X)},[X,a]);let K=(0,r.useMemo)(()=>{let e=[];return e=b.trim()?(0,c.TI)(b):[...Object.values(c.ZP).flat(),...U],"all"!==p&&(e=e.filter(e=>(k[e.id]||e.category)===p)),e},[p,b,U,k,E]),J=e=>{let t=new Set(f);t.has(e)?t.delete(e):t.add(e),j(t)},Q=(e,t,a)=>{C(s=>{let r=s[e];return r?{...s,[e]:{...r,[t]:a}}:s})},$=(e,t)=>{let a=K.find(t=>t.id===e);a&&C(s=>{let r=s[e]||a.dimensions;if("rectangle"===t){let t={shape:"rectangle",width:"circle"===r.shape?2*r.radius:r.width,height:"circle"===r.shape?2*r.radius:r.height,depth:r.depth};return{...s,[e]:t}}{let t={shape:"circle",radius:"rectangle"===r.shape?Math.max(r.width,r.height)/2:r.radius,depth:r.depth};return{...s,[e]:t}}})},ee=Object.keys(c.ZP),et=(0,r.useMemo)(()=>{let e=new Set;return ee.forEach(t=>e.add(t)),Object.values(k).forEach(t=>e.add(t)),U.forEach(t=>{let a=k[t.id]||t.category;e.add(a)}),Array.from(e).sort()},[ee,k,U]);return d?(0,s.jsx)("div",{className:"bg-white border-r border-gray-200 flex flex-col ".concat(l),children:(0,s.jsxs)("div",{className:"p-2",children:[(0,s.jsx)("div",{className:"text-center mb-2",children:(0,s.jsx)("span",{className:"text-lg",children:"\uD83E\uDD8E"})}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("button",{onClick:()=>x("all"),className:"w-full p-2 rounded text-xs transition-colors ".concat("all"===p?"bg-blue-500 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-700"),title:"All Equipment",children:"\uD83D\uDCE6"}),et.map(e=>(0,s.jsx)("button",{onClick:()=>x(e),className:"w-full p-2 rounded text-xs transition-colors ".concat(p===e?"bg-blue-500 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-700"),title:g[e],children:h[e]},e))]})]})}):(0,s.jsxs)("div",{className:"bg-white border-r border-gray-200 flex flex-col ".concat(l),style:o,children:[(0,s.jsxs)("div",{className:"p-4 border-b border-gray-200",children:[(0,s.jsx)("h3",{className:"font-semibold text-gray-900 mb-3",children:"Equipment Library"}),(0,s.jsxs)("div",{className:"mb-3 space-y-2",children:[(0,s.jsx)("button",{onClick:()=>{let e=V+1,t="custom-".concat(e),a={id:t,name:"New Equipment",category:"equipment",dimensions:{shape:"rectangle",width:4,height:4},clearance:{type:"rectangular",all:2},color:"#6B7280",description:"Custom equipment item",specifications:{capacity:1},tags:["custom"]};G(e),C(e=>({...e,[t]:a.dimensions})),N(e=>new Set([...e,t])),W(e=>[...e,a])},className:"w-full px-3 py-2 bg-green-500 text-white text-sm rounded-lg hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-green-500 transition-colors",children:"➕ Add New Equipment"}),(0,s.jsx)("button",{onClick:()=>Y(!0),className:"w-full px-3 py-2 bg-blue-500 text-white text-sm rounded-lg hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors",children:"\uD83D\uDCDA Manage Library"})]}),(0,s.jsx)("div",{className:"mb-3",children:(0,s.jsx)("input",{type:"text",placeholder:"Search equipment...",value:b,onChange:e=>y(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 bg-white placeholder-gray-500"})}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-1",children:[(0,s.jsx)("button",{onClick:()=>x("all"),className:"px-2 py-1 text-xs rounded ".concat("all"===p?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"All"}),et.map(e=>(0,s.jsx)("button",{onClick:()=>x(e),className:"px-2 py-1 text-xs rounded ".concat(p===e?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),title:g[e],children:h[e]},e))]})]}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto p-4",children:(0,s.jsx)("div",{className:"space-y-2",children:0===K.length?(0,s.jsxs)("div",{className:"text-center text-gray-500 py-8",children:[(0,s.jsx)("p",{children:"No equipment found"}),b&&(0,s.jsx)("button",{onClick:()=>y(""),className:"text-blue-500 hover:text-blue-700 text-sm mt-2",children:"Clear search"})]}):K.map(e=>{let a=f.has(e.id),r=v.has(e.id),i=w[e.id],n=k[e.id],l=E[e.id],o=i||e.dimensions,c=n||e.category,d=l||e.name,u=i||n||l;return(0,s.jsxs)("div",{className:"border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[(0,s.jsx)("div",{className:"p-3 cursor-pointer",onClick:()=>(e=>{let a=w[e.id],s=k[e.id],r=E[e.id],i=P[e.id],n=q[e.id],l=L[e.id],o=I[e.id],c=B[e.id],d=O[e.id];console.log("Equipment Library - handleEquipmentClick:",{equipmentId:e.id,equipmentName:e.name,customClearanceValue:d,hasCustomClearance:!!d});let u={...e,...a&&{dimensions:a},...s&&{category:s},...r&&{name:r},...void 0!==i&&{weight:i},...void 0!==n&&{capacity:n},...void 0!==l&&{turnAroundTime:l},...void 0!==o&&{verticalHeight:o},...void 0!==c&&{rideClearing:c},...d&&{clearance:d}};console.log("Equipment Library - equipmentToPlace:",{id:u.id,name:u.name,clearance:u.clearance}),t(u)})(e),children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-lg",children:h[c]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"font-medium text-sm text-gray-900",children:[d,u&&(0,s.jsx)("span",{className:"text-blue-600 ml-1",children:"*"})]}),(0,s.jsx)("div",{className:"text-xs text-gray-500",children:"circle"===o.shape?"".concat(o.radius," radius").concat(o.depth?" \xd7 ".concat(o.depth):""):"".concat(o.width," \xd7 ").concat(o.height).concat(o.depth?" \xd7 ".concat(o.depth):"")})]})]})}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("button",{onClick:t=>{t.stopPropagation(),a||J(e.id),(e=>{let t=new Set(v);if(t.has(e))t.delete(e);else if(t.add(e),!w[e]){let t=K.find(t=>t.id===e);t&&C(a=>({...a,[e]:{...t.dimensions}}))}N(t)})(e.id)},className:"p-1 hover:bg-gray-200 rounded text-xs ".concat(r?"bg-blue-100 text-blue-600":"text-gray-600"),title:"Edit dimensions",children:"\uD83D\uDCCF"}),(0,s.jsx)("button",{onClick:t=>{t.stopPropagation(),J(e.id)},className:"p-1 rounded transition-colors ".concat(a?"bg-blue-100 hover:bg-blue-200 text-blue-700":"hover:bg-gray-200 text-gray-700"),title:"Toggle details",children:(0,s.jsx)("svg",{className:"w-4 h-4 transform transition-all duration-200 ".concat(a?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:2.5,children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})})})]})]})}),a&&(0,s.jsx)("div",{className:"px-3 pb-3 border-t border-gray-100",children:(0,s.jsxs)("div",{className:"text-xs text-gray-600 space-y-1 mt-2",children:[e.description&&(0,s.jsx)("p",{children:e.description}),r&&(0,s.jsxs)("div",{className:"bg-blue-50 p-3 rounded-lg mb-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)("span",{className:"font-medium text-blue-900",children:"Edit Dimensions"}),(0,s.jsx)("button",{onClick:()=>(e=>{let t=K.find(t=>t.id===e);t&&(C(a=>({...a,[e]:{...t.dimensions}})),S(t=>{let{[e]:a,...s}=t;return s}),D(t=>{let{[e]:a,...s}=t;return s}))})(e.id),className:"text-xs text-blue-600 hover:text-blue-800",children:"Reset"})]}),(0,s.jsxs)("div",{className:"mb-3",children:[(0,s.jsx)("label",{className:"block text-xs font-medium text-blue-900 mb-1",children:"Name"}),(0,s.jsx)("input",{type:"text",value:E[e.id]||e.name,onChange:t=>{var a,s;return a=e.id,s=t.target.value,void D(e=>({...e,[a]:s}))},className:"w-full px-2 py-1 text-xs border border-blue-200 rounded focus:outline-none focus:ring-1 focus:ring-blue-500 text-gray-900 bg-white placeholder-gray-500",placeholder:"Equipment name"})]}),(0,s.jsxs)("div",{className:"mb-3",children:[(0,s.jsx)("label",{className:"block text-xs font-medium text-blue-900 mb-1",children:"Shape"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:t=>{t.stopPropagation(),$(e.id,"rectangle")},className:"px-3 py-1 text-xs rounded ".concat("rectangle"===o.shape?"bg-blue-600 text-white":"bg-blue-100 text-blue-700 hover:bg-blue-200"),children:"⬜ Rectangle"}),(0,s.jsx)("button",{onClick:t=>{t.stopPropagation(),$(e.id,"circle")},className:"px-3 py-1 text-xs rounded ".concat("circle"===o.shape?"bg-blue-600 text-white":"bg-blue-100 text-blue-700 hover:bg-blue-200"),children:"⭕ Circle"})]})]}),(0,s.jsxs)("div",{className:"mb-3",children:[(0,s.jsx)("label",{className:"block text-xs font-medium text-blue-900 mb-1",children:"Category"}),(0,s.jsxs)("select",{value:k[e.id]||e.category,onChange:t=>{var a,s;return a=e.id,s=t.target.value,void S(e=>({...e,[a]:s}))},className:"w-full px-2 py-1 text-xs border border-blue-200 rounded focus:outline-none focus:ring-1 focus:ring-blue-500 text-gray-900 bg-white",children:[(0,s.jsx)("option",{value:"mega-rides",children:"\uD83C\uDFA2 Mega Rides"}),(0,s.jsx)("option",{value:"rides",children:"\uD83C\uDFA0 Rides"}),(0,s.jsx)("option",{value:"kiddy-rides",children:"\uD83C\uDFAA Kiddy Rides"}),(0,s.jsx)("option",{value:"food",children:"\uD83C\uDF54 Food"}),(0,s.jsx)("option",{value:"games",children:"\uD83C\uDFAF Games"}),(0,s.jsx)("option",{value:"equipment",children:"⚙️ Equipment"}),(0,s.jsx)("option",{value:"office",children:"\uD83C\uDFE2 Office"}),(0,s.jsx)("option",{value:"home",children:"\uD83C\uDFE0 Home"}),(0,s.jsx)("option",{value:"bunks",children:"\uD83D\uDECF️ Bunks"})]})]}),"rectangle"===o.shape?(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs font-medium text-blue-900 mb-1",children:"Width (ft)"}),(0,s.jsx)("input",{type:"number",min:"0.1",step:"0.1",value:o.width||0,onChange:t=>Q(e.id,"width",parseFloat(t.target.value)||0),className:"w-full px-2 py-1 text-xs border border-blue-200 rounded focus:outline-none focus:ring-1 focus:ring-blue-500 text-gray-900 bg-white",onClick:e=>e.stopPropagation()})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs font-medium text-blue-900 mb-1",children:"Height (ft)"}),(0,s.jsx)("input",{type:"number",min:"0.1",step:"0.1",value:o.height||0,onChange:t=>Q(e.id,"height",parseFloat(t.target.value)||0),className:"w-full px-2 py-1 text-xs border border-blue-200 rounded focus:outline-none focus:ring-1 focus:ring-blue-500 text-gray-900 bg-white",onClick:e=>e.stopPropagation()})]}),void 0!==o.depth&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs font-medium text-blue-900 mb-1",children:"Depth (ft)"}),(0,s.jsx)("input",{type:"number",min:"0.1",step:"0.1",value:o.depth||0,onChange:t=>Q(e.id,"depth",parseFloat(t.target.value)||0),className:"w-full px-2 py-1 text-xs border border-blue-200 rounded focus:outline-none focus:ring-1 focus:ring-blue-500 text-gray-900 bg-white",onClick:e=>e.stopPropagation()})]})]}):(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs font-medium text-blue-900 mb-1",children:"Radius (ft)"}),(0,s.jsx)("input",{type:"number",min:"0.1",step:"0.1",value:o.radius||0,onChange:t=>Q(e.id,"radius",parseFloat(t.target.value)||0),className:"w-full px-2 py-1 text-xs border border-blue-200 rounded focus:outline-none focus:ring-1 focus:ring-blue-500 text-gray-900 bg-white",onClick:e=>e.stopPropagation()})]}),void 0!==o.depth&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs font-medium text-blue-900 mb-1",children:"Depth (ft)"}),(0,s.jsx)("input",{type:"number",min:"0.1",step:"0.1",value:o.depth||0,onChange:t=>Q(e.id,"depth",parseFloat(t.target.value)||0),className:"w-full px-2 py-1 text-xs border border-blue-200 rounded focus:outline-none focus:ring-1 focus:ring-blue-500 text-gray-900 bg-white",onClick:e=>e.stopPropagation()})]})]}),(0,s.jsxs)("div",{className:"mt-4 pt-3 border-t border-blue-200",children:[(0,s.jsx)("h4",{className:"text-xs font-medium text-blue-900 mb-3",children:"Operational Specifications"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs font-medium text-blue-900 mb-1",children:"Weight (lbs)"}),(0,s.jsx)("input",{type:"number",min:"0",step:"1",value:P[e.id]||e.weight||"",onChange:t=>F(a=>({...a,[e.id]:parseFloat(t.target.value)||0})),className:"w-full px-2 py-1 text-xs border border-blue-200 rounded focus:outline-none focus:ring-1 focus:ring-blue-500",placeholder:"Equipment weight",onClick:e=>e.stopPropagation()})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs font-medium text-blue-900 mb-1",children:"Ride Capacity"}),(0,s.jsx)("input",{type:"number",min:"0",step:"1",value:q[e.id]||e.capacity||"",onChange:t=>A(a=>({...a,[e.id]:parseFloat(t.target.value)||0})),className:"w-full px-2 py-1 text-xs border border-blue-200 rounded focus:outline-none focus:ring-1 focus:ring-blue-500",placeholder:"Number of riders",onClick:e=>e.stopPropagation()})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs font-medium text-blue-900 mb-1",children:"Turn Around Time (min)"}),(0,s.jsx)("input",{type:"number",min:"0",step:"0.5",value:L[e.id]||e.turnAroundTime||"",onChange:t=>T(a=>({...a,[e.id]:parseFloat(t.target.value)||0})),className:"w-full px-2 py-1 text-xs border border-blue-200 rounded focus:outline-none focus:ring-1 focus:ring-blue-500",placeholder:"Loading time",onClick:e=>e.stopPropagation()})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs font-medium text-blue-900 mb-1",children:"Vertical Height (ft)"}),(0,s.jsx)("input",{type:"number",min:"0",step:"0.1",value:I[e.id]||e.verticalHeight||"",onChange:t=>M(a=>({...a,[e.id]:parseFloat(t.target.value)||0})),className:"w-full px-2 py-1 text-xs border border-blue-200 rounded focus:outline-none focus:ring-1 focus:ring-blue-500",placeholder:"Height above ground",onClick:e=>e.stopPropagation()})]}),(0,s.jsxs)("div",{className:"col-span-2",children:[(0,s.jsx)("label",{className:"block text-xs font-medium text-blue-900 mb-1",children:"Ride Clearance (ft)"}),(0,s.jsx)("input",{type:"number",min:"0",step:"0.1",value:B[e.id]||e.rideClearing||"",onChange:t=>z(a=>({...a,[e.id]:parseFloat(t.target.value)||0})),className:"w-full px-2 py-1 text-xs border border-blue-200 rounded focus:outline-none focus:ring-1 focus:ring-blue-500",placeholder:"Required clearance around ride",onClick:e=>e.stopPropagation()})]})]}),(0,s.jsxs)("div",{className:"mt-4 pt-3 border-t border-blue-200",children:[(0,s.jsx)("button",{onClick:t=>{t.stopPropagation(),_(e.id)},className:"w-full px-3 py-2 bg-purple-500 text-white text-xs rounded hover:bg-purple-600 transition-colors",children:"\uD83C\uDFAF Edit Custom Clearance Zone"}),(0,s.jsx)("p",{className:"text-xs text-blue-600 mt-1",children:"Create polygonal clearance zones with curves"})]})]}),(0,s.jsx)("div",{className:"text-xs text-blue-700 mt-3",children:"* Custom specifications will be applied when placed on canvas"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Category:"}),(0,s.jsx)("br",{}),g[k[e.id]||e.category],k[e.id]&&(0,s.jsx)("span",{className:"text-blue-600",children:" (custom)"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Dimensions:"}),(0,s.jsx)("br",{}),"circle"===o.shape?"⭕ ".concat(o.radius," radius").concat(o.depth?" \xd7 ".concat(o.depth):""):"⬜ ".concat(o.width," \xd7 ").concat(o.height).concat(o.depth?" \xd7 ".concat(o.depth):""),i&&(0,s.jsx)("span",{className:"text-blue-600",children:" (custom)"})]}),(q[e.id]||e.capacity)&&(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Capacity:"}),(0,s.jsx)("br",{}),q[e.id]||e.capacity," riders",q[e.id]&&(0,s.jsx)("span",{className:"text-blue-600",children:" (custom)"})]}),(P[e.id]||e.weight)&&(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Weight:"}),(0,s.jsx)("br",{}),P[e.id]||e.weight," lbs",P[e.id]&&(0,s.jsx)("span",{className:"text-blue-600",children:" (custom)"})]}),(L[e.id]||e.turnAroundTime)&&(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Turn Around:"}),(0,s.jsx)("br",{}),L[e.id]||e.turnAroundTime," min",L[e.id]&&(0,s.jsx)("span",{className:"text-blue-600",children:" (custom)"})]}),(I[e.id]||e.verticalHeight)&&(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Height:"}),(0,s.jsx)("br",{}),I[e.id]||e.verticalHeight," tall",I[e.id]&&(0,s.jsx)("span",{className:"text-blue-600",children:" (custom)"})]}),(B[e.id]||e.rideClearing)&&(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Ride Clearance:"}),(0,s.jsx)("br",{}),B[e.id]||e.rideClearing," clearance",B[e.id]&&(0,s.jsx)("span",{className:"text-blue-600",children:" (custom)"})]}),e.clearance&&(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Clearance:"}),(0,s.jsx)("br",{}),"rectangular"===e.clearance.type&&e.clearance.all?"".concat(e.clearance.all,"' all sides"):"custom"===e.clearance.type?"Custom polygon":"Custom"]})]}),e.tags&&e.tags.length>0&&(0,s.jsx)("div",{className:"mt-2",children:(0,s.jsx)("div",{className:"flex flex-wrap gap-1",children:e.tags.map(e=>(0,s.jsx)("span",{className:"px-1.5 py-0.5 bg-gray-100 text-gray-600 rounded text-xs",children:e},e))})})]})})]},e.id)})})}),(0,s.jsx)("div",{className:"p-4 border-t border-gray-200 bg-gray-50",children:(0,s.jsxs)("div",{className:"text-xs text-gray-500 text-center",children:[K.length," item",1!==K.length?"s":""," available"]})}),H&&(()=>{let e=K.find(e=>e.id===H);if(!e)return null;let t=w[e.id]||e.dimensions,a=B[e.id]||e.rideClearing||0,r=O[e.id]||e.clearance;return(0,s.jsx)(u,{clearance:r,dimensions:t,rideClearing:a,onChange:t=>{R(a=>({...a,[e.id]:t}))},onClose:()=>_(null)})})(),(0,s.jsx)(m,{equipmentDefinitions:X,onEquipmentDefinitionsUpdate:(e,t)=>{W([]),C({}),S({}),D({}),F({}),A({}),T({}),M({}),z({}),R({});let a=new Set(Object.values(c.ZP).flat().map(e=>e.id)),s=e.filter(e=>!a.has(e.id));W(s),t&&(t.customDimensions&&C(t.customDimensions),t.customCategories&&S(t.customCategories),t.customNames&&D(t.customNames),t.customWeight&&F(t.customWeight),t.customCapacity&&A(t.customCapacity),t.customTurnAroundTime&&T(t.customTurnAroundTime),t.customVerticalHeight&&M(t.customVerticalHeight),t.customRideClearing&&z(t.customRideClearing),t.customClearances&&R(t.customClearances),console.log("Custom settings restored:",t)),console.log("Equipment library updated:",{total:e.length,custom:s.length,base:e.length-s.length,customSettingsRestored:!!t})},customSettings:{customDimensions:w,customCategories:k,customNames:E,customWeight:P,customCapacity:q,customTurnAroundTime:L,customVerticalHeight:I,customRideClearing:B,customClearances:O},isOpen:Z,onClose:()=>Y(!1)})]})};function x(e){let{isOpen:t,onClose:a,onNewProject:i,onLoadProject:n,onSaveProject:l,currentProjectName:c}=e,[d,u]=(0,r.useState)("new"),[m,g]=(0,r.useState)([]),[h,p]=(0,r.useState)(""),[x,b]=(0,r.useState)(""),[y,f]=(0,r.useState)(c||""),[j,v]=(0,r.useState)(""),[N,w]=(0,r.useState)(null);(0,r.useEffect)(()=>{t&&(g(o.getSavedProjects()),f(c||""))},[t,c]);let C=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return t?(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[80vh] overflow-hidden",children:[(0,s.jsx)("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-200",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Project Manager"}),(0,s.jsx)("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 transition-colors",title:"Close",children:(0,s.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,s.jsx)("div",{className:"border-b border-gray-200",children:(0,s.jsx)("nav",{className:"flex space-x-8 px-6",children:[{id:"new",label:"New Project",icon:"\uD83D\uDCC4"},{id:"open",label:"Open Project",icon:"\uD83D\uDCC2"},{id:"save",label:"Save Project",icon:"\uD83D\uDCBE"}].map(e=>(0,s.jsxs)("button",{onClick:()=>u(e.id),className:"py-4 px-1 border-b-2 font-medium text-sm transition-colors ".concat(d===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[(0,s.jsx)("span",{className:"mr-2",children:e.icon}),e.label]},e.id))})}),(0,s.jsxs)("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:["new"===d&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Create New Project"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Project Name *"}),(0,s.jsx)("input",{type:"text",value:h,onChange:e=>p(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white placeholder-gray-500",placeholder:"Enter project name"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description (Optional)"}),(0,s.jsx)("textarea",{value:x,onChange:e=>b(e.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white placeholder-gray-500",placeholder:"Enter project description"})]})]})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,s.jsx)("button",{onClick:a,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,s.jsx)("button",{onClick:()=>{h.trim()&&(i(h.trim(),x.trim()||void 0),p(""),b(""),a())},disabled:!h.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:"Create Project"})]})]}),"open"===d&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Open Existing Project"}),0===m.length?(0,s.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,s.jsx)("svg",{className:"w-12 h-12 mx-auto mb-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,s.jsx)("p",{children:"No saved projects found"}),(0,s.jsx)("p",{className:"text-sm",children:"Create a new project or import an existing one"})]}):(0,s.jsx)("div",{className:"space-y-3",children:m.map(e=>(0,s.jsx)("div",{className:"p-4 border rounded-lg cursor-pointer transition-colors ".concat((null==N?void 0:N.metadata.id)===e.metadata.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"),onClick:()=>w(e),children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h4",{className:"font-medium text-gray-900",children:e.metadata.name}),e.metadata.description&&(0,s.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.metadata.description}),(0,s.jsxs)("div",{className:"flex items-center space-x-4 mt-2 text-xs text-gray-500",children:[(0,s.jsxs)("span",{children:["Created: ",C(e.metadata.createdAt)]}),(0,s.jsxs)("span",{children:["Updated: ",C(e.metadata.updatedAt)]}),(0,s.jsxs)("span",{children:[e.placedEquipment.length," equipment items"]}),(0,s.jsxs)("span",{children:[e.backgroundImages.length," background images"]})]})]}),(0,s.jsx)("button",{onClick:t=>{var a;t.stopPropagation(),a=e.metadata.id,confirm("Are you sure you want to delete this project? This action cannot be undone.")&&(o.deleteProject(a),g(o.getSavedProjects()),(null==N?void 0:N.metadata.id)===a&&w(null))},className:"ml-4 p-2 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete project",children:(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})},e.metadata.id))})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,s.jsx)("button",{onClick:a,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,s.jsx)("button",{onClick:()=>{N&&(n(N),a())},disabled:!N,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:"Open Project"})]})]}),"save"===d&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Save Current Project"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Project Name *"}),(0,s.jsx)("input",{type:"text",value:y,onChange:e=>f(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white placeholder-gray-500",placeholder:"Enter project name"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description (Optional)"}),(0,s.jsx)("textarea",{value:j,onChange:e=>v(e.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white placeholder-gray-500",placeholder:"Enter project description"})]})]})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,s.jsx)("button",{onClick:a,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,s.jsx)("button",{onClick:()=>{y.trim()&&(l(y.trim(),j.trim()||void 0),a())},disabled:!y.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:"Save Project"})]})]})]})]})}):null}function b(e){let{isOpen:t,onClose:a,onImport:i,placedEquipment:n,backgroundImages:l,equipmentDefinitions:c,customEquipmentCount:d,projectName:u}=e,[m,g]=(0,r.useState)("export"),[h,p]=(0,r.useState)({includeBackgroundImages:!0,includeCustomEquipment:!0,compressionLevel:"none",format:"json"}),[x,b]=(0,r.useState)(u||"lot-planner-project"),[y,f]=(0,r.useState)({loading:!1}),j=(0,r.useRef)(null),v=async e=>{var t;let s=null==(t=e.target.files)?void 0:t[0];if(s){f({loading:!0});try{let e=await o.readProjectFile(s),t=o.importProject(e);f({loading:!1,result:t}),t.success&&(i(t),a())}catch(e){f({loading:!1,result:{success:!1,error:"Failed to read file: ".concat(e instanceof Error?e.message:"Unknown error")}})}j.current&&(j.current.value="")}};return t?(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[80vh] overflow-hidden",children:[(0,s.jsx)("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-200",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Export / Import Project"}),(0,s.jsx)("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 transition-colors",title:"Close",children:(0,s.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,s.jsx)("div",{className:"border-b border-gray-200",children:(0,s.jsx)("nav",{className:"flex space-x-8 px-6",children:[{id:"export",label:"Export Project",icon:"\uD83D\uDCE4"},{id:"import",label:"Import Project",icon:"\uD83D\uDCE5"}].map(e=>(0,s.jsxs)("button",{onClick:()=>g(e.id),className:"py-4 px-1 border-b-2 font-medium text-sm transition-colors ".concat(m===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[(0,s.jsx)("span",{className:"mr-2",children:e.icon}),e.label]},e.id))})}),(0,s.jsxs)("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:["export"===m&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Export Current Project"}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"File Name"}),(0,s.jsx)("input",{type:"text",value:x,onChange:e=>b(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white placeholder-gray-500",placeholder:"Enter file name"}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["File will be saved as: ",x,".lotplan"]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h4",{className:"font-medium text-gray-900",children:"Export Options"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("label",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",checked:h.includeBackgroundImages,onChange:e=>p(t=>({...t,includeBackgroundImages:e.target.checked})),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,s.jsxs)("span",{className:"ml-2 text-sm text-gray-700",children:["Include background images (",l.length," images)"]})]}),(0,s.jsxs)("label",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",checked:h.includeCustomEquipment,onChange:e=>p(t=>({...t,includeCustomEquipment:e.target.checked})),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,s.jsxs)("span",{className:"ml-2 text-sm text-gray-700",children:["Include custom equipment definitions (",d," custom items)"]})]})]})]}),(0,s.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,s.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Project Summary"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm text-gray-600",children:[(0,s.jsxs)("div",{children:["Equipment Items: ",n.length]}),(0,s.jsxs)("div",{children:["Background Images: ",l.length]}),(0,s.jsxs)("div",{children:["Custom Equipment: ",d]}),(0,s.jsxs)("div",{children:["Total Equipment Types: ",c.length]})]})]})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,s.jsx)("button",{onClick:a,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,s.jsx)("button",{onClick:()=>{try{let e=o.exportProject(n,l,c,d,x,h);o.downloadProject(e,x),a()}catch(e){console.error("Export failed:",e),alert("Export failed. Please try again.")}},disabled:!x.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:"Export Project"})]})]}),"import"===m&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Import Project File"}),(0,s.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:[(0,s.jsx)("svg",{className:"w-12 h-12 mx-auto mb-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),(0,s.jsx)("p",{className:"text-lg font-medium text-gray-900 mb-2",children:"Select a project file to import"}),(0,s.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:"Choose a .lotplan file exported from Lot Planner"}),(0,s.jsx)("button",{onClick:()=>{var e;null==(e=j.current)||e.click()},disabled:y.loading,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:y.loading?"Loading...":"Choose File"})]}),(0,s.jsx)("input",{ref:j,type:"file",accept:".lotplan,.json",onChange:v,className:"hidden",title:"Select project file","aria-label":"Select project file to import"}),y.result&&(0,s.jsx)("div",{className:"p-4 rounded-lg ".concat(y.result.success?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"),children:y.result.success?(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center mb-2",children:[(0,s.jsx)("svg",{className:"w-5 h-5 text-green-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),(0,s.jsx)("span",{className:"font-medium text-green-800",children:"Import Successful"})]}),y.result.data&&(0,s.jsxs)("div",{className:"text-sm text-green-700",children:[(0,s.jsxs)("p",{children:["Project: ",y.result.data.metadata.name]}),(0,s.jsxs)("p",{children:["Equipment: ",y.result.data.placedEquipment.length," items"]}),(0,s.jsxs)("p",{children:["Background Images: ",y.result.data.backgroundImages.length," images"]})]}),y.result.warnings&&(0,s.jsxs)("div",{className:"mt-2 text-sm text-yellow-700",children:[(0,s.jsx)("p",{className:"font-medium",children:"Warnings:"}),(0,s.jsx)("ul",{className:"list-disc list-inside",children:y.result.warnings.map((e,t)=>(0,s.jsx)("li",{children:e},t))})]})]}):(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center mb-2",children:[(0,s.jsx)("svg",{className:"w-5 h-5 text-red-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),(0,s.jsx)("span",{className:"font-medium text-red-800",children:"Import Failed"})]}),(0,s.jsx)("p",{className:"text-sm text-red-700",children:y.result.error})]})}),(0,s.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,s.jsx)("h4",{className:"font-medium text-blue-900 mb-2",children:"Import Instructions"}),(0,s.jsxs)("ul",{className:"text-sm text-blue-800 space-y-1",children:[(0,s.jsx)("li",{children:"• Select a .lotplan file exported from Lot Planner"}),(0,s.jsx)("li",{children:"• The import will replace your current project"}),(0,s.jsx)("li",{children:"• Make sure to save your current work before importing"}),(0,s.jsx)("li",{children:"• Large files with background images may take longer to load"})]})]})]}),(0,s.jsx)("div",{className:"flex justify-end space-x-3",children:(0,s.jsx)("button",{onClick:a,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"})})]})]})]})}):null}var y=a(26597),f=a(52699),j=a.n(f);class v{static async exportToPDF(e,t,a,s,r,i){try{let s=this.PAPER_SIZES[r.paperSize],n=new y.Ay({orientation:r.orientation,unit:"in",format:[s.width,s.height]}),l=this.getQualityScale(r.quality),o=await j()(e,{scale:l,useCORS:!0,allowTaint:!0,backgroundColor:"#ffffff",logging:!1}),c=n.internal.pageSize.getWidth(),d=n.internal.pageSize.getHeight(),u=c-1,m=d-1;this.addTitlePage(n,r,i,c,d),n.addPage(),this.addHeader(n,r.title,i,c,.5);let g=o.width/o.height,h=u,p=u/g,x=m-1.5;p>x&&(h=(p=x)*g);let b=.5+(u-h)/2,f=o.toDataURL("image/png");n.addImage(f,"PNG",b,1.5,h,p),r.includeScale&&this.addScaleBar(n,b,1.5+p+.1,h),r.includeEquipmentLabels&&this.addEquipmentLegend(n,t,a,c,d,.5),this.addFooter(n,i,c,d,.5),t.length>0&&(n.addPage(),this.addEquipmentDetailsPage(n,t,a,r,i,c,d,.5));let v="".concat(i.projectName.replace(/[^a-z0-9]/gi,"_"),"_layout_").concat(new Date().toISOString().split("T")[0],".pdf");n.save(v)}catch(e){throw console.error("PDF export failed:",e),Error("PDF export failed: ".concat(e instanceof Error?e.message:"Unknown error"))}}static getQualityScale(e){switch(e){case"low":return 1;case"medium":default:return 2;case"high":return 3}}static addTitlePage(e,t,a,s,r){let i=s/2;e.setFontSize(24),e.setFont("helvetica","bold"),e.text(t.title,i,2,{align:"center"}),t.subtitle&&(e.setFontSize(16),e.setFont("helvetica","normal"),e.text(t.subtitle,i,2.8,{align:"center"})),e.setFontSize(14),e.setFont("helvetica","bold"),e.text("Project Information",i,4.5,{align:"center"}),e.setFontSize(12),e.setFont("helvetica","normal"),e.text("Project Name: ".concat(a.projectName),1,5.2),e.text("Created By: ".concat(a.createdBy),1,5.5),e.text("Date: ".concat(a.createdDate),1,5.8),e.text("Scale: ".concat(a.scale),1,6.1),e.text("Total Area: ".concat(a.totalArea),1,6.4),e.text("Equipment Count: ".concat(a.equipmentCount),1,6.7),e.setFontSize(14),e.setFont("helvetica","bold"),e.text("Export Settings",i,7.5,{align:"center"}),e.setFontSize(12),e.setFont("helvetica","normal"),e.text("Paper Size: ".concat(t.paperSize.toUpperCase()),1,8.2),e.text("Orientation: ".concat(t.orientation),1,8.5),e.text("Quality: ".concat(t.quality),1,8.799999999999999),e.text("Background Images: ".concat(t.includeBackground?"Yes":"No"),1,9.1),e.text("Equipment Labels: ".concat(t.includeEquipmentLabels?"Yes":"No"),1,9.399999999999999),e.text("Clearance Zones: ".concat(t.includeClearanceZones?"Yes":"No"),1,9.7),e.text("Dimensions: ".concat(t.includeDimensions?"Yes":"No"),1,10),e.setFontSize(10),e.setFont("helvetica","italic"),e.text("Generated by Lot Planner",i,r-.5,{align:"center"})}static addHeader(e,t,a,s,r){e.setFontSize(16),e.setFont("helvetica","bold"),e.text(t,r,r+.3),e.setFontSize(10),e.setFont("helvetica","normal"),e.text("".concat(a.projectName," - ").concat(a.createdDate),s-r,r+.3,{align:"right"}),e.setLineWidth(.01),e.line(r,r+.5,s-r,r+.5)}static addScaleBar(e,t,a,s){let r=Math.min(2,.3*s),i=Math.round(72*r/this.PIXELS_PER_FOOT);e.setFillColor(0,0,0),e.rect(t,a,r,.1,"F"),e.setFontSize(8),e.setFont("helvetica","normal"),e.text("0",t,a+.1+.15),e.text("".concat(i,"'"),t+r,a+.1+.15,{align:"right"}),e.text("Scale",t+r/2,a-.05,{align:"center"})}static addEquipmentLegend(e,t,a,s,r,i){let n=new Map;t.forEach(e=>{let t=a.find(t=>t.id===e.equipmentId);if(t){let e=t.id;n.has(e)?n.get(e).count++:n.set(e,{name:t.name,count:1,category:t.category})}});let l=s-i-2.5,o=i+1.5,c=Math.min(.25*n.size+.5,r-o-i);e.setDrawColor(0,0,0),e.setLineWidth(.01),e.rect(l,o,2.3,c),e.setFontSize(10),e.setFont("helvetica","bold"),e.text("Equipment Legend",l+.1,o+.2),e.setFontSize(8),e.setFont("helvetica","normal");let d=o+.4;Array.from(n.values()).forEach((t,a)=>{d+.2<o+c-.1&&(e.text("• ".concat(t.name," (").concat(t.count,")"),l+.1,d),d+=.2)})}static addFooter(e,t,a,s,r){let i=s-r;e.setFontSize(8),e.setFont("helvetica","normal"),e.text("Generated: ".concat(new Date().toLocaleString()),r,i),e.text("Page ".concat(e.internal.getCurrentPageInfo().pageNumber),a-r,i,{align:"right"})}static addEquipmentDetailsPage(e,t,a,s,r,i,n,l){this.addHeader(e,"Equipment Details",r,i,l);let o=l+1,c=new Map;t.forEach(e=>{let t=a.find(t=>t.id===e.equipmentId);if(t){let a=t.category;c.has(a)||c.set(a,[]),c.get(a).push({placed:e,definition:t})}}),c.forEach((t,a)=>{e.setFontSize(12),e.setFont("helvetica","bold"),e.text(a,l,o),o+=.25,e.setFontSize(9),e.setFont("helvetica","normal"),t.forEach(t=>{let{placed:a,definition:c}=t;o+.6>n-l&&(e.addPage(),this.addHeader(e,"Equipment Details (continued)",r,i,l),o=l+1),e.setFont("helvetica","bold"),e.text("".concat(c.name),l+.2,o),o+=.15,e.setFont("helvetica","normal");let d=Math.round(a.x/this.PIXELS_PER_FOOT),u=Math.round(a.y/this.PIXELS_PER_FOOT);if(e.text("Position: (".concat(d,"', ").concat(u,"')"),l+.4,o),o+=.15,s.includeDimensions&&a.dimensions){let t=a.dimensions;"rectangle"===t.shape?e.text("Dimensions: ".concat(t.width,"' \xd7 ").concat(t.height,"'"),l+.4,o):e.text("Dimensions: ".concat(t.radius,"' radius"),l+.4,o),o+=.15}0!==a.rotation&&(e.text("Rotation: ".concat(Math.round(a.rotation),"\xb0"),l+.4,o),o+=.15),o+=.3}),o+=.3}),o+=.3,e.setFontSize(12),e.setFont("helvetica","bold"),e.text("Summary",l,o),o+=.25,e.setFontSize(9),e.setFont("helvetica","normal"),e.text("Total Equipment: ".concat(t.length),l+.2,o),o+=.15,e.text("Categories: ".concat(c.size),l+.2,o),this.addFooter(e,r,i,n,l)}}function N(e){let{isOpen:t,onClose:a,canvasElement:i,placedEquipment:n,equipmentDefinitions:l,backgroundImages:o,projectName:c}=e,[d,u]=(0,r.useState)(!1),[m,g]=(0,r.useState)(i);(0,r.useEffect)(()=>{if(t&&!m){console.log("Modal opened, trying to find canvas element directly");let e=document.querySelector(".konvajs-content");e?(console.log("Found canvas container directly:",e),g(e)):console.log("Canvas container not found in DOM")}},[t,m]),(0,r.useEffect)(()=>{i&&(console.log("Canvas element prop updated:",i),g(i))},[i]);let[h,p]=(0,r.useState)({includeBackground:!0,includeEquipmentLabels:!0,includeClearanceZones:!0,includeDimensions:!0,includeScale:!0,paperSize:"letter",orientation:"landscape",title:"".concat(c," Layout"),subtitle:"Carnival/Fair Site Plan",showGrid:!1,quality:"medium"}),[x,b]=(0,r.useState)({projectName:c,createdBy:"Lot Planner User",createdDate:new Date().toLocaleDateString(),scale:'1" = 10 feet',totalArea:"250,000 sq ft (500' \xd7 500')",equipmentCount:n.length}),y=async()=>{if(console.log("PDF Export - Canvas element:",m),!m){console.log("PDF Export failed - no canvas element available"),alert("Canvas not available for export. Please try again.");return}u(!0);try{await v.exportToPDF(m,n,l,o,h,{...x,equipmentCount:n.length}),a()}catch(e){console.error("PDF export failed:",e),alert("PDF export failed: ".concat(e instanceof Error?e.message:"Unknown error"))}finally{u(!1)}};return t?(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[(0,s.jsx)("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-200",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Export to PDF"}),(0,s.jsx)("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 transition-colors",title:"Close",children:(0,s.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,s.jsx)("div",{className:"p-6 overflow-y-auto max-h-[75vh]",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsx)("div",{className:"space-y-6",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Export Options"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Paper Size"}),(0,s.jsxs)("select",{value:h.paperSize,onChange:e=>p(t=>({...t,paperSize:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white placeholder-gray-500","aria-label":"Paper size selection",children:[(0,s.jsx)("option",{value:"letter",children:'Letter (8.5" \xd7 11")'}),(0,s.jsx)("option",{value:"legal",children:'Legal (8.5" \xd7 14")'}),(0,s.jsx)("option",{value:"a4",children:'A4 (8.27" \xd7 11.69")'}),(0,s.jsx)("option",{value:"a3",children:'A3 (11.69" \xd7 16.53")'})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Orientation"}),(0,s.jsxs)("select",{value:h.orientation,onChange:e=>p(t=>({...t,orientation:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white placeholder-gray-500","aria-label":"Page orientation selection",children:[(0,s.jsx)("option",{value:"landscape",children:"Landscape (Recommended)"}),(0,s.jsx)("option",{value:"portrait",children:"Portrait"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quality"}),(0,s.jsxs)("select",{value:h.quality,onChange:e=>p(t=>({...t,quality:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white placeholder-gray-500",children:[(0,s.jsx)("option",{value:"low",children:"Low (Faster, Smaller File)"}),(0,s.jsx)("option",{value:"medium",children:"Medium (Balanced)"}),(0,s.jsx)("option",{value:"high",children:"High (Best Quality, Larger File)"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("h4",{className:"font-medium text-gray-900",children:"Include in PDF"}),(0,s.jsxs)("label",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",checked:h.includeBackground,onChange:e=>p(t=>({...t,includeBackground:e.target.checked})),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,s.jsxs)("span",{className:"ml-3 text-sm text-gray-700",children:["\uD83D\uDDBC️ Background Images (",o.length," images)"]})]}),(0,s.jsxs)("label",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",checked:h.includeEquipmentLabels,onChange:e=>p(t=>({...t,includeEquipmentLabels:e.target.checked})),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,s.jsx)("span",{className:"ml-3 text-sm text-gray-700",children:"\uD83C\uDFF7️ Equipment Labels & Legend"})]}),(0,s.jsxs)("label",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",checked:h.includeClearanceZones,onChange:e=>p(t=>({...t,includeClearanceZones:e.target.checked})),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,s.jsx)("span",{className:"ml-3 text-sm text-gray-700",children:"⚠️ Clearance Zones"})]}),(0,s.jsxs)("label",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",checked:h.includeDimensions,onChange:e=>p(t=>({...t,includeDimensions:e.target.checked})),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,s.jsx)("span",{className:"ml-3 text-sm text-gray-700",children:"\uD83D\uDCCF Equipment Dimensions"})]}),(0,s.jsxs)("label",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",checked:h.includeScale,onChange:e=>p(t=>({...t,includeScale:e.target.checked})),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,s.jsx)("span",{className:"ml-3 text-sm text-gray-700",children:"\uD83D\uDCD0 Scale Bar"})]}),(0,s.jsxs)("label",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",checked:h.showGrid,onChange:e=>p(t=>({...t,showGrid:e.target.checked})),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,s.jsx)("span",{className:"ml-3 text-sm text-gray-700",children:"⊞ Grid Lines"})]})]})]})}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Document Information"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Title"}),(0,s.jsx)("input",{type:"text",value:h.title,onChange:e=>p(t=>({...t,title:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white placeholder-gray-500","aria-label":"Document title",placeholder:"Enter document title"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subtitle (Optional)"}),(0,s.jsx)("input",{type:"text",value:h.subtitle||"",onChange:e=>p(t=>({...t,subtitle:e.target.value||void 0})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white placeholder-gray-500",placeholder:"e.g., Carnival/Fair Site Plan","aria-label":"Document subtitle"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Created By"}),(0,s.jsx)("input",{type:"text",value:x.createdBy,onChange:e=>b(t=>({...t,createdBy:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white placeholder-gray-500","aria-label":"Author name"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Scale"}),(0,s.jsx)("input",{type:"text",value:x.scale,onChange:e=>b(t=>({...t,scale:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white placeholder-gray-500"})]})]})]}),(0,s.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,s.jsx)("h4",{className:"font-medium text-gray-900 mb-3",children:"Project Summary"}),(0,s.jsxs)("div",{className:"space-y-2 text-sm text-gray-600",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{children:"Project Name:"}),(0,s.jsx)("span",{className:"font-medium",children:c})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{children:"Equipment Count:"}),(0,s.jsx)("span",{className:"font-medium",children:n.length})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{children:"Background Images:"}),(0,s.jsx)("span",{className:"font-medium",children:o.length})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{children:"Total Area:"}),(0,s.jsx)("span",{className:"font-medium",children:x.totalArea})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{children:"Export Date:"}),(0,s.jsx)("span",{className:"font-medium",children:x.createdDate})]})]})]}),(0,s.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,s.jsx)("h4",{className:"font-medium text-blue-900 mb-2",children:"\uD83D\uDCC4 Export Preview"}),(0,s.jsxs)("div",{className:"text-sm text-blue-800 space-y-1",children:[(0,s.jsx)("p",{children:"• Title page with project information"}),(0,s.jsxs)("p",{children:["• Layout diagram with ",h.includeBackground?"background images":"white background"]}),h.includeEquipmentLabels&&(0,s.jsx)("p",{children:"• Equipment legend and labels"}),h.includeScale&&(0,s.jsx)("p",{children:"• Scale bar for measurements"}),(0,s.jsx)("p",{children:"• Equipment details page with specifications"}),(0,s.jsx)("p",{children:"• Professional formatting for permits/presentations"})]})]})]})]})}),(0,s.jsx)("div",{className:"bg-gray-50 px-6 py-4 border-t border-gray-200",children:(0,s.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,s.jsx)("button",{onClick:a,disabled:d,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 disabled:opacity-50 transition-colors",children:"Cancel"}),(0,s.jsx)("button",{onClick:y,disabled:d||!m,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors flex items-center",children:d?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Generating PDF..."]}):(0,s.jsx)(s.Fragment,{children:"\uD83D\uDCC4 Export PDF"})})]})})]})}):null}v.PIXELS_PER_FOOT=10,v.PAPER_SIZES={letter:{width:8.5,height:11},legal:{width:8.5,height:14},a4:{width:8.27,height:11.69},a3:{width:11.69,height:16.53}};let w=e=>{let{isOpen:t,onClose:a}=e;return t?(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-96 max-h-[80vh] overflow-y-auto",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Canvas Properties & Settings"}),(0,s.jsx)("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,s.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,s.jsxs)("div",{className:"p-4 space-y-4",children:[(0,s.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg",children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Canvas Info"}),(0,s.jsxs)("div",{className:"space-y-1 text-sm text-gray-600",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Size:"})," 250,000 sq ft"]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Dimensions:"})," 500' \xd7 500'"]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Scale:"})," 10 px/ft"]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Canvas Scale"}),(0,s.jsx)("div",{className:"text-sm text-gray-600",children:"10 pixels = 1 foot"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Grid Size"}),(0,s.jsx)("input",{type:"number",defaultValue:50,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm text-gray-900 bg-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Grid size in pixels"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Background"}),(0,s.jsx)("button",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm hover:bg-gray-50 transition-colors",children:"Upload Image"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Display Settings"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("label",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",defaultChecked:!0,className:"mr-2"}),(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Show grid"})]}),(0,s.jsxs)("label",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",defaultChecked:!0,className:"mr-2"}),(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Show equipment labels"})]}),(0,s.jsxs)("label",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",defaultChecked:!0,className:"mr-2"}),(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Show clearance zones"})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Measurement Units"}),(0,s.jsxs)("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm text-gray-900 bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,s.jsx)("option",{value:"feet",children:"Feet"}),(0,s.jsx)("option",{value:"meters",children:"Meters"}),(0,s.jsx)("option",{value:"yards",children:"Yards"})]})]})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-2 p-4 border-t border-gray-200",children:[(0,s.jsx)("button",{onClick:a,className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"Cancel"}),(0,s.jsx)("button",{onClick:a,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Apply Settings"})]})]})}):null},C=(0,i.default)(()=>Promise.all([a.e(904),a.e(310),a.e(249)]).then(a.bind(a,13249)),{loadableGenerated:{webpack:()=>[13249]},ssr:!1}),k=(0,i.default)(()=>a.e(744).then(a.bind(a,47744)),{loadableGenerated:{webpack:()=>[47744]},ssr:!1});function S(){let[e,t]=(0,r.useState)([]),[a,i]=(0,r.useState)([]),[n,l]=(0,r.useState)([]),[c,d]=(0,r.useState)([]),[u,m]=(0,r.useState)(null),[g,h]=(0,r.useState)(!1),[y,f]=(0,r.useState)(!1),[j,v]=(0,r.useState)(!1),[S,E]=(0,r.useState)(0),[D,P]=(0,r.useState)(!1),[F,q]=(0,r.useState)(null),[A,L]=(0,r.useState)(!0),[T,I]=(0,r.useState)(!1),[M,B]=(0,r.useState)(null);(0,r.useEffect)(()=>{let t=setInterval(()=>{D&&o.autoSave(e,c,n,S)},3e4);return()=>clearInterval(t)},[e,c,n,S,D]),(0,r.useEffect)(()=>{P(!0)},[e,c,n]),(0,r.useEffect)(()=>{let e=o.loadAutoSave();e&&e.placedEquipment.length>0&&confirm("Auto-saved data found from ".concat(new Date(e.timestamp).toLocaleString(),". Would you like to restore it?"))&&(t(e.placedEquipment),d(e.backgroundImages),l(e.equipmentDefinitions),E(e.customEquipmentCount),P(!0))},[]);let z=(t,a)=>{let s={metadata:{id:(null==u?void 0:u.metadata.id)||"project_".concat(Date.now()),name:t,description:a,createdAt:(null==u?void 0:u.metadata.createdAt)||new Date().toISOString(),updatedAt:new Date().toISOString(),version:"1.0.0",author:"Lot Planner User"},canvasSettings:{width:5e3,height:5e3,pixelsPerFoot:10,gridSize:50,gridVisible:!0,scaleBarVisible:!0,measurementToolActive:!1},placedEquipment:e,backgroundImages:c,equipmentDefinitions:n,customEquipmentCount:S,equipmentLibraryState:M||void 0},r=o.saveProject(s);r.success?(m(s),P(!1),alert("Project saved successfully!")):alert("Failed to save project: ".concat(r.error))},O=e=>{m(e),t(e.placedEquipment),d(e.backgroundImages),l(e.equipmentDefinitions),E(e.customEquipmentCount),B(e.equipmentLibraryState||null),i([]),P(!1),o.clearAutoSave()};return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[(0,s.jsx)("header",{className:"bg-white shadow-sm border-b",children:(0,s.jsx)("div",{className:"px-6 py-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("span",{className:"text-2xl mr-3",children:"\uD83E\uDD8E"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Lot Lizard"}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:[u?u.metadata.name:"Carnival Lot Planning",D&&(0,s.jsx)("span",{className:"text-orange-500 ml-2",children:"• Unsaved changes"})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("button",{onClick:()=>I(!0),className:"px-3 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors text-sm",title:"Canvas Properties & Settings",children:"⚙️ Settings"}),(0,s.jsx)("button",{onClick:()=>h(!0),className:"px-3 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors text-sm",children:"\uD83D\uDCC1 Projects"}),(0,s.jsx)("button",{onClick:()=>f(!0),className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 transition-colors",children:"\uD83D\uDCC1 Export/Import"}),(0,s.jsx)("button",{onClick:()=>v(!0),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"\uD83D\uDCC4 Export PDF"}),(0,s.jsxs)("button",{onClick:()=>{u?z(u.metadata.name,u.metadata.description):h(!0)},className:"px-4 py-2 rounded-lg transition-colors ".concat(D?"bg-orange-600 text-white hover:bg-orange-700":"bg-blue-600 text-white hover:bg-blue-700"),children:["\uD83D\uDCBE ",u?"Save":"Save Project"]})]})]})})}),(0,s.jsxs)("div",{className:"flex h-[calc(100vh-80px)]",children:[(0,s.jsxs)("div",{className:"relative transition-all duration-300 ".concat(A?"w-[340px]":"w-12"),children:[(0,s.jsx)("button",{onClick:()=>L(!A),className:"absolute top-4 -right-3 z-20 bg-white border border-gray-300 rounded-full w-6 h-6 flex items-center justify-center shadow-md hover:bg-gray-50 transition-colors",title:A?"Collapse Equipment Library":"Expand Equipment Library",children:(0,s.jsx)("span",{className:"text-xs text-gray-600",children:A?"◀":"▶"})}),(0,s.jsx)(p,{onEquipmentSelect:e=>{let a=5e3,s=5e3;if(c&&c.length>0){let e=c[0],t=0;c.forEach(a=>{let s=(a.width||0)*(a.scaleX||1)*((a.height||0)*(a.scaleY||1));s>t&&(t=s,e=a)});let r=(e.width||0)*(e.scaleX||1),i=(e.height||0)*(e.scaleY||1);a=(e.x||0)+r/2,s=(e.y||0)+i/2,console.log("Placing equipment at satellite image center: (".concat(Math.round(a),", ").concat(Math.round(s),")"),{imageSize:"".concat(Math.round(r),"x").concat(Math.round(i)),imagePosition:"(".concat(e.x,", ").concat(e.y,")")})}else console.log("No satellite images found, placing equipment at canvas center: (".concat(a,", ").concat(s,")"));let r={id:"equipment_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),equipmentId:e.id,x:a,y:s,rotation:0,dimensions:e.dimensions,clearance:e.clearance,customLabel:void 0};t(e=>[...e,r]),i([r.id])},onEquipmentDefinitionsChange:e=>{l(e),E(e.filter(e=>e.id.startsWith("custom_")).length)},onLibraryStateChange:B,initialLibraryState:M||void 0,className:"h-full transition-all duration-300 ".concat(A?"w-[340px]":"w-12 overflow-hidden"),isCollapsed:!A},"equipment-library")]}),(0,s.jsxs)("div",{className:"flex-1 relative flex flex-col",children:[(0,s.jsx)(C,{className:"w-full h-full flex-1",placedEquipment:e,equipmentDefinitions:n,onEquipmentSelect:e=>{e?i([e.id]):i([])},onEquipmentMove:(e,a,s)=>{t(t=>t.map(t=>t.id===e?{...t,x:a,y:s}:t))},onEquipmentRotate:(e,a)=>{t(t=>t.map(t=>t.id===e?{...t,rotation:a}:t))},onEquipmentDelete:e=>{t(t=>t.filter(t=>t.id!==e)),a.includes(e)&&i(t=>t.filter(t=>t!==e))},selectedEquipmentId:a[0]||void 0,backgroundImages:c,onBackgroundImageAdd:e=>{let t={...e,id:"bg-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9))};d(e=>[...e,t])},onBackgroundImageUpdate:(e,t)=>{d(a=>a.map(a=>a.id===e?{...a,...t}:a))},onBackgroundImageDelete:e=>{d(t=>t.filter(t=>t.id!==e))},onCanvasReady:e=>{console.log("Canvas element received in parent:",e),q(e)}}),(0,s.jsx)(k,{selectedEquipmentIds:a,placedEquipment:e,onEquipmentDelete:e=>{t(t=>t.filter(t=>!e.includes(t.id))),i([])},onEquipmentDuplicate:a=>{let s=e.filter(e=>a.includes(e.id)).map(e=>({...e,id:"equipment_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),x:e.x+50,y:e.y+50,dimensions:e.dimensions}));t(e=>[...e,...s]),i(s.map(e=>e.id))},onSelectAll:()=>{i(e.map(e=>e.id))},onDeselectAll:()=>{i([])}})]})]}),(0,s.jsx)(x,{isOpen:g,onClose:()=>h(!1),onNewProject:(e,a)=>{m(o.createNewProject(e,a)),t([]),d([]),l([]),E(0),B(null),i([]),P(!1),o.clearAutoSave()},onLoadProject:O,onSaveProject:z,currentProjectName:null==u?void 0:u.metadata.name}),(0,s.jsx)(b,{isOpen:y,onClose:()=>f(!1),onImport:e=>{e.success&&e.data?(O(e.data),e.warnings&&e.warnings.length>0?alert("Project imported with warnings:\n".concat(e.warnings.join("\n"))):alert("Project imported successfully!")):alert("Import failed: ".concat(e.error))},placedEquipment:e,backgroundImages:c,equipmentDefinitions:n,customEquipmentCount:S,projectName:(null==u?void 0:u.metadata.name)||"lot-planner-project"}),(0,s.jsx)(N,{isOpen:j,onClose:()=>v(!1),canvasElement:F,placedEquipment:e,backgroundImages:c,equipmentDefinitions:n,projectName:(null==u?void 0:u.metadata.name)||"lot-planner-layout"}),(0,s.jsx)(w,{isOpen:T,onClose:()=>I(!1)})]})}}},e=>{e.O(0,[930,316,62,441,964,358],()=>e(e.s=28521)),_N_E=e.O()}]);